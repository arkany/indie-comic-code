//TODO: // PLACE DESIRED PAGE FROM O1-PSD FOLDER// LOCK THAT LAYER// NOTE: DEFINE YOUR SCRIPT FOLDER AND WHERE TO SAVE AS A VARIABLE// var pageNumber;var textArray = new Array();var myFont = app.textFonts.getByName("ComicGeek");var fontSize = 7;var scriptFolder = "00-assets";var letteringFolder = "02-Lettering";//------------------ADD LAYERS------------------------//var doc = app.activeDocument;var bubbleLayerAdd = doc.layers.add("Bubbles");bubbleLayerAdd.name = "Bubbles";var bubbleLayer = doc.layers.getByName("Bubbles");var dialogueLayerAdd = doc.layers.add("Dialogue");dialogueLayerAdd.name = "Dialogue";var dialogueLayer = doc.layers.getByName("Dialogue");//-----------------PROMPT what page would you like?-----------------//// There should be a prompt for the PSD page and then glean the page number form the PSD file name.var pageRequest = prompt("What page would you like?", "1");if(pageRequest !=null){        pageNumber = pageRequest;} else {        //stop application}//alert("Page " + pageNumber);// DEFINE COMIC SCRIPT FILE PATH//TODO: If no active document, create a new document. Based on the name of the document, you will know what page it is for.var docFolder = File(activeDocument.path);var folderShorten = docFolder.toString().replace(letteringFolder,"");var scriptDocPath = folderShorten + (scriptFolder + "/script.txt");//NOTE: The script needs to be called script.txt. Perhaps it should just open anything called script in the script folder? I dunno if that's any better.//alert(scriptDocPath);//OPEN FILEvar scriptFile = File (scriptDocPath);scriptFile.open();var txtFile = scriptFile.read();scriptFile.close();var pagePlus = 1;//alert("PageNumber = " + pageNumber);var pageNumberEnd = +pageNumber + +pagePlus;var pageStart = "Page " + pageNumber;var pageEnd = "Page " + pageNumberEnd;//alert(pageStart + " begin and end is " + pageEnd);// find Page #var topOfPage = txtFile.search(pageStart);var bottomOfPage = txtFile.search(pageEnd);$.writeln(topOfPage + "is the topOfPage (or page line number) and " + bottomOfPage + "is the end page.\n");var scriptPage = txtFile.slice(topOfPage, bottomOfPage);//alert(scriptPage);var startingLine;//so this is a list of all of the breaksvar allBreaks = scriptPage.match(/\n/g);//alert(allBreaks.length + " is the total.");var startLine = 0;var endLine = txtFile.search("\n");//alert(endLine + 1);for (i = 0; i < allBreaks.length; i++) {    var newDialogue = scriptPage.slice(startLine,endLine);    var hasColon = newDialogue.search(":");    //alert(hasColon);    if (hasColon != -1) {        newDialogue = newDialogue.slice(hasColon + 1);        var pushToArray = textArray.push(newDialogue);        //call addDialogue        addDialogue(i);    } else {        // do nothing    }    startLine = endLine + 1;    endLine = scriptPage.indexOf("\n",startLine);}//----------CREATE TEXT FRAMES for each item in Array--------------//function addDialogue(i) {             var rectRef = doc.pathItems.rectangle((50 - (i * 50)), -150, 100, 100);  //       var rectRef = doc.pathItems.rectangle(50, -150, 100, 100);         var areaTextRef = doc.textFrames.areaText(rectRef);         areaTextRef.contents = newDialogue;        areaTextRef.textRange.size = fontSize;        areaTextRef.textRange.characterAttributes.textFont = myFont;//        dialogueCounter = dialogueCounter + 1;//areaTextRef.selected = true;} 