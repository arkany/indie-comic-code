//TODO: Run action to setup page, then do all of this?var pageNumber;var textArray = new Array();var myFont = app.textFonts.getByName("ComicGeek");//------------------ADD LAYERS------------------------//var doc = app.activeDocument;var bubbleLayerAdd = doc.layers.add("Bubbles");bubbleLayerAdd.name = "Bubbles";var bubbleLayer = doc.layers.getByName("Bubbles");var dialogueLayerAdd = doc.layers.add("Dialogue");dialogueLayerAdd.name = "Dialogue";var dialogueLayer = doc.layers.getByName("Dialogue");//-----------------PROMPT what page would you like?-----------------//var pageRequest = prompt("What page would you like?", "1");if(pageRequest !=null){        pageNumber = pageRequest;} else {        //stop application}//alert("Page " + pageNumber);// DEFINE COMIC SCRIPT FILE PATHvar docFolder = File(activeDocument.path);var folderShorten = docFolder.toString().replace("02-Lettering","");var scriptDocPath = folderShorten + ("00-assets/script.txt");//alert(scriptDocPath);//OPEN FILEvar scriptFile = File (scriptDocPath);scriptFile.open();var txtFile = scriptFile.read();scriptFile.close();var pagePlus = 1;//alert("PageNumber = " + pageNumber);var pageNumberEnd = +pageNumber + +pagePlus;var pageStart = "Page " + pageNumber;var pageEnd = "Page " + pageNumberEnd;//alert(pageStart + " begin and end is " + pageEnd);// find Page #var topOfPage = txtFile.search(pageStart);var bottomOfPage = txtFile.search(pageEnd);alert(topOfPage + "is the topOfPage and " + bottomOfPage + "is the end page.");var scriptPage = txtFile.slice(topOfPage, bottomOfPage);//alert(scriptPage);var startingLine;//so this is a list of all of the breaksvar allBreaks = scriptPage.match(/\n/g);//alert(allBreaks.length + " is the total.");var startLine = 0;var endLine = txtFile.search("\n");//alert(endLine + 1);for (i = 0; i < allBreaks.length; i++) {    var newDialogue = scriptPage.slice(startLine,endLine);    var hasColon = newDialogue.search(":");    //alert(hasColon);    if (hasColon != -1) {        newDialogue = newDialogue.slice(hasColon + 1);        var pushToArray = textArray.push(newDialogue);        addDialogue();    } else {        // do nothing    }    startLine = endLine + 1;    endLine = scriptPage.indexOf("\n",startLine);}//----------CREATE TEXT FRAMES for each item in Array--------------//var dialogueCounter = 0;function addDialogue() {    //for ( i = 0; i < textArray.length; i++) { ///                 var rectRef = doc.pathItems.rectangle((50 - (dialogueCounter * 50)), -150, 100, 100);         var areaTextRef = doc.textFrames.areaText(rectRef);         areaTextRef.contents = newDialogue;        areaTextRef.textRange.size = 7;        areaTextRef.textRange.characterAttributes.textFont = myFont;        dialogueCounter = dialogueCounter + 1;//areaTextRef.selected = true;    //}} 